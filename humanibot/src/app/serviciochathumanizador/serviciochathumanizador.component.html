<app-cabecera [datoscabecera]="datosDelUsuario"></app-cabecera>



<div class="px-4 md:px-4 mt-28">
    <div class="bg-white dark:bg-gray-900 shadow-lg rounded-2xl p-6 h-[calc(100vh-8em)]
           flex flex-col gap-6 border border-gray-200 dark:border-gray-700">

        <!-- Header -->
        <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Humanizador de Texto</h2>

            <button (click)="clickAbrirModal()"
                class="bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-2 px-4 rounded-lg shadow">
                {{ textoBotonMarketing }}
            </button>
        </div>

        <p class="text-xl text-gray-600 dark:text-gray-400">
            Ingrese un √∫nico p√°rrafo cuyo contenido tenga entre <strong>100</strong> y <strong>1230</strong> caracteres.
        </p>
        <!-- Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-1 relative">
            <!-- Spinner en el medio (grande) -->
            <!-- Spinner en el medio -->
            <div *ngIf="humanizando"
                class="absolute inset-0 flex flex-col items-center justify-center z-10 bg-black bg-opacity-20 max-lg:h-[calc(100vh-0.5em)]">

                <div class="animate-pulse">
                    <h1 class="text-xl md:text-7xl font-bold flex items-center text-black dark:text-white drop-shadow-[0_0_10px_rgba(0,0,0,0.4)] 
           dark:drop-shadow-[0_0_15px_rgba(255,255,255,255.8)]">
                        Humanizand
                        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24"
                            class="animate-spin ml-2" height="1.5em" width="1.5em" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM13.6695 15.9999H10.3295L8.95053 17.8969L9.5044 19.6031C10.2897 19.8607 11.1286 20 12 20C12.8714 20 13.7103 19.8607 14.4956 19.6031L15.0485 17.8969L13.6695 15.9999ZM5.29354 10.8719L4.00222 11.8095L4 12C4 13.7297 4.54894 15.3312 5.4821 16.6397L7.39254 16.6399L8.71453 14.8199L7.68654 11.6499L5.29354 10.8719ZM18.7055 10.8719L16.3125 11.6499L15.2845 14.8199L16.6065 16.6399L18.5179 16.6397C19.4511 15.3312 20 13.7297 20 12L19.997 11.81L18.7055 10.8719ZM12 9.536L9.656 11.238L10.552 14H13.447L14.343 11.238L12 9.536ZM14.2914 4.33299L12.9995 5.27293V7.78993L15.6935 9.74693L17.9325 9.01993L18.4867 7.3168C17.467 5.90685 15.9988 4.84254 14.2914 4.33299ZM9.70757 4.33329C8.00021 4.84307 6.53216 5.90762 5.51261 7.31778L6.06653 9.01993L8.30554 9.74693L10.9995 7.78993V5.27293L9.70757 4.33329Z">
                            </path>
                        </svg>
                        <span class="ml-2"> . . . </span>
                    </h1>
                </div>
            </div>



            <!-- Columna izquierda -->
            <div class="flex flex-col gap-2 h-full">
                <p-iconfield class="flex-1">
                    <textarea pTextarea style="font-size: 16px" spellcheck="false" [(ngModel)]="valorprimertextarea"
                        [ngClass]="{'border-green-500 ring-2 ring-green-400': pegoTexto}"
                        (animationend)="pegoTexto = false" class="w-full h-full border rounded-xl outline-none overflow-auto 
                   dark:bg-gray-800 dark:text-white transition-all resize-none"
                        placeholder="Pega aqu√≠ el texto generado por IA..."></textarea>
                    <p-inputicon class="pi pi-clipboard" (click)="pegarTexto()"
                        title="Pegar desde portapapeles"></p-inputicon>
                </p-iconfield>

                <div *ngIf="valorprimertextarea" [ngClass]="{
                    'text-green-500': valorprimertextarea.length >= 100 && valorprimertextarea.length <= 1230,
                    'text-red-500': valorprimertextarea.length < 100 || valorprimertextarea.length > 1230,
                    'dark:text-red-300': valorprimertextarea.length < 100 || valorprimertextarea.length > 1230
                    }" class="text-sm -mt-1 mb-2">
                    {{ getContadorTextoYCaracteres(valorprimertextarea) }} / 1230
                </div>


                <p-button label="Humanizar" (click)="humanizarTexto()" class="full-width-btn" [disabled]="humanizando">
                </p-button>
            </div>

            <!-- Columna derecha -->
            <div class="flex flex-col h-full">
                <p-iconfield class="flex-1">
                    <textarea pTextarea style="font-size: 16px" spellcheck="false" [(ngModel)]="valorsegundotextarea"
                        class="w-full h-full border rounded-xl outline-none overflow-auto 
                   dark:bg-gray-800 dark:text-white resize-none" placeholder="Aqu√≠ aparecer√° el texto humanizado..."
                        readonly></textarea>
                    <p-inputicon class="pi pi-copy" (click)="copiarTexto()" title="Copiar texto"></p-inputicon>
                </p-iconfield>

                <div *ngIf="valorsegundotextarea" class="text-sm text-gray-400 mt-1">
                    {{ getContadorTextoYCaracteres(valorsegundotextarea) }}
                </div>


            </div>

        </div>

        <!-- Bot√≥n limpiar -->
        <div class="flex justify-start">
            <button [disabled]="humanizando" (click)="limpiarTodo()" [ngClass]="humanizando 
      ? 'bg-gray-400 cursor-not-allowed' 
      : 'bg-red-500 hover:bg-red-600'" class="text-white font-semibold py-2 px-4 rounded-lg shadow">
                üóë Limpiar todo
            </button>
        </div>


    </div>
</div>


@if (modalVisible) {
<app-modalprecios [datosDelUsuario]="datosDelUsuario" (cerrar)="modalVisible = false"></app-modalprecios>
}

<app-avisarusuariodelplanexpirado></app-avisarusuariodelplanexpirado>



<!-- Modal L√≠mite Alcanzado (429) -->
@if (modalVisibleParaLimite) {
<!-- Modal Backdrop -->
<div class="fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <!-- Modal Container -->
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all">
        <!-- Modal Header -->
        <div class="p-6 pb-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-3">
                    <!-- Warning Icon -->
                    <div
                        class="flex-shrink-0 w-10 h-10 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                            L√≠mite Alcanzado
                        </h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400">
                            Has excedido el l√≠mite de peticiones
                        </p>
                    </div>
                </div>
                <!-- Close Button -->
                <button (click)="modalVisibleParaLimite = false"
                    class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Modal Body -->
        <div class="px-6 pb-6">
            <!-- Rate Limit Info -->
            <div
                class="bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4 mb-6">
                <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0">
                        <svg class="w-5 h-5 text-amber-600 dark:text-amber-400 mt-0.5" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-amber-800 dark:text-amber-200 mb-2">
                            <strong> {{mensajeError}} </strong>
                        </p>
                    </div>
                </div>
            </div>


            <!-- Suggestions -->
            <div class="space-y-3 mb-6">
                <h4 class="text-sm font-medium text-gray-900 dark:text-white">¬øQu√© puedes hacer?</h4>
                <ul class="space-y-2">
                    <li class="flex items-start space-x-3">
                        <div
                            class="flex-shrink-0 w-5 h-5 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mt-0.5">
                            <svg class="w-3 h-3 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <span class="text-sm text-gray-600 dark:text-gray-300"> {{subMensaje}} </span>
                    </li>
                    <li class="flex items-start space-x-3">
                        <div
                            class="flex-shrink-0 w-5 h-5 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mt-0.5">
                            <svg class="w-3 h-3 text-green-600 dark:text-green-400" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                            </svg>
                        </div>
                        <span class="text-sm text-gray-600 dark:text-gray-300">

                            @if (datosPlanCuenta?.plan === 'premium') {

                            Podemos dise√±ar un plan personalizado que se ajuste a tus necesidades.
                            }
                            @else {
                            Actualiza tu plan para m√°s
                            peticiones
                            }

                        </span>
                    </li>
                    <li class="flex items-start space-x-3">
                        <div
                            class="flex-shrink-0 w-5 h-5 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mt-0.5">
                            <svg class="w-3 h-3 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                            </svg>
                        </div>
                        <span class="text-sm text-gray-600 dark:text-gray-300">Optimiza tus peticiones para usar menos
                            recursos</span>
                    </li>
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="flex space-x-3">
                <button (click)="modalVisibleParaLimite = false"
                    class="flex-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 px-4 py-2.5 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    Entendido
                </button>
                @if (datosPlanCuenta?.plan !== 'premium') {
                <button (click)="abrirModalPrecios()"
                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2.5 rounded-lg font-medium transition-colors">
                    Ver Planes
                </button>
                }
            </div>
        </div>
    </div>
</div>
}

<!-- Modal Plan Expirado (430) -->
@if (modalVisiblePlanExpirado) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full p-6">
        <div class="flex items-center space-x-3 mb-4">
            <div class="flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 9v2m0 4h.01M4.5 19h15c1.38 0 2.25-1.56 1.55-2.74L13.55 4.26a2 2 0 00-3.1 0L2.95 16.26C2.25 17.44 3.12 19 4.5 19z" />
                </svg>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-red-600">Plan Expirado</h3>
                <p class="text-sm text-gray-500">{{mensajeError}}</p>
            </div>
        </div>
        <div class="space-y-3 mb-6">
            <p class="text-sm text-gray-700 dark:text-gray-300">
                Tu plan ha llegado a su fin, pero no te preocupes.
                üí° <strong>Renueva hoy</strong> y obt√©n acceso inmediato a nuestras funciones premium sin
                interrupciones.
                Aprovecha nuestras <span class="text-blue-600 font-semibold">ofertas especiales por tiempo
                    limitado</span>.
            </p>
        </div>
        <div class="flex space-x-3">
            <button (click)="cerrarModalexperiado()"
                class="flex-1 bg-gray-100 px-4 py-2 rounded-lg dark:text-black">Cerrar</button>
            <button (click)="abrirModalPrecios()" class="flex-1 bg-green-600 text-white px-4 py-2 rounded-lg">Renovar
                Ahora</button>
        </div>
    </div>
</div>
}

@if (modalVisibleErrorServidor) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full p-6">
        <div class="flex items-center space-x-3 mb-4">
            <div class="flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 9v2m0 4h.01M4.5 19h15c1.38 0 2.25-1.56 1.55-2.74L13.55 4.26a2 2 0 00-3.1 0L2.95 16.26C2.25 17.44 3.12 19 4.5 19z" />
                </svg>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-red-600">Error de Servidor</h3>
                <p class="text-sm text-gray-500">{{ mensajeError || 'Ocurri√≥ un problema con el servidor.' }}</p>
            </div>
        </div>
        <div class="space-y-3 mb-6">
            <p class="text-sm text-gray-700 dark:text-gray-300">
                En este momento no podemos procesar tu solicitud debido a un error interno en el servidor causado por
                una actualizaci√≥n.
                El servicio deber√≠a estar disponible nuevamente en unos 5 a 10 minutos.
                Por favor, int√©ntalo nuevamente m√°s tarde o contacta con nuestro equipo de soporte si el problema
                persiste.

            </p>
        </div>
        <div class="flex space-x-3">
            <button (click)="modalVisibleErrorServidor=false"
                class="flex-1 bg-gray-100 px-4 py-2 rounded-lg dark:text-black">Cerrar</button>
            <button (click)="humanizarTexto()" class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg">
                Reintentar
            </button>
        </div>
    </div>
</div>
}












@if (modalVisibleErrorCaracteres) {
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-md w-full p-6">
        <div class="flex items-center space-x-3 mb-4">
            <div class="flex-shrink-0 w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 9v2m0 4h.01M4.5 19h15c1.38 0 2.25-1.56 1.55-2.74L13.55 4.26a2 2 0 00-3.1 0L2.95 16.26C2.25 17.44 3.12 19 4.5 19z" />
                </svg>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-yellow-600"> {{ tituloModalCaracteres}}</h3>
                <p class="text-sm text-gray-500">{{ mensajeError }}</p>
            </div>
        </div>
        <div class="space-y-3 mb-6">
            <p class="text-sm text-gray-700 dark:text-gray-300">
                {{parrafoModalCaracteres}}
            </p>
        </div>
        <div class="flex space-x-3">
            <button (click)="modalVisibleErrorCaracteres=false"
                class="flex-1 bg-gray-100 px-4 py-2 rounded-lg dark:text-black">Cerrar</button>
        </div>
    </div>
</div>
}




<div class="absolute bottom-5 right-5 max-lg:-bottom-16">
    <app-nuestrobot titulo="ü§ñ ¬°Hola Humano!"
        [descripcion]="'¬øTienes alguna duda, un problema t√©cnico, o necesitas ayuda con una migraci√≥n?<br/>¬°S√≠guenos en nuestras redes sociales para estar al tanto de todo!<br/>Si el problema persiste, escr√≠benos directamente a nuestro WhatsApp para asistencia personalizada.'">
    </app-nuestrobot>
</div>